
\section{Tutorial}
\label{section:tutorial}
\setcounter{footnote}{0}

Here's a tutorial walk-through of how to use \rscape. This should
suffice to get you started.

\subsection {Modes of \rscape}

\begin{tabular}{ll}
\multicolumn{2}{l}{\textbf{MSA input \textit{with} annotated consensus secondary structure:}} \\ 
 & \\ 
\textbf{}   & Reports all pairs that have covariation scores with E-values smaller or equal to a target E-value.\\
\textbf{}   & Draws the given consensus structure annotated with the significantly covarying base pairs.\\
 & \\ 
\multicolumn{2}{l}{\textbf{MSA input \textit{without} an annotated secondary structure:}}  \\
 & \\ 
\textbf{}   & Reports all pairs that have covariation scores with E-values smaller or equal to a target E-value.\\
\textbf{}   & Builds the best consensus structure that includes all significantly covarying pairs,\\
\textbf{}   & \hspace{5mm}\emph{the maximum-covariation optimal consensus structure}.\\
\textbf{}   & Draws the \emph{maximum-covariation optimal consensus structure} annotated with the significantly \\
\textbf{}   & \hspace{5mm}covarying base pairs.\\
 & \\ 
\end{tabular} 

I'll show examples of running each mode, using examples in the
\ccode{tutorial/} subdirectory of the distribution.


\subsection{Files used in the tutorial}

The subdirectory \prog{/tutorial} in the \rscape\ distribution contains the
files used in the tutorial. 

The tutorial provides several examples of RNA structural
alignments, all in Stockholm format:

\begin{sreitems}{\emprog{updated\_Arisong.sto}}
\item[\emprog{updated\_Arisong.sto}] Structural alignment of the ciliate
  Arisong RNA. This alignment is an updated
  version of the one published in~\citep{JungEddy11}.
\item[\emprog{ar14.sto}] Structural alignment of the $\alpha$-proteobacteria ncRNA ar14. This alignment is an updated version of the one
  published in~\citep{delVal12}.
\item[\emprog{RF00005.sto}] Rfam v12.0~\citep{Nawrocki15} seed alignment of tRNA. 
\item[\emprog{RF00001-noss.sto}] Rfam v12.0 seed alignment of 5S rRNA, after removing the consensus secondary structure. 
\end{sreitems}


\subsection{Running \rscape\, on one alignment file}
To run \rscape\ with default parameters on alignment file
\prog{tutorial/updated\_Arisong.sto} use:\\

\user{bin/R-scape tutorial/updated\_Arisong.sto}\\

\noindent
The output is a list of the signifcantly covarying positions

\begin{sreoutput}
# R-scape :: RNA Structural Covariation Above Phylogenetic Expectation
# R-scape 0.2 (June 2016)
# Copyright (C) 2016 Howard Hughes Medical Institute.
# Freely distributed under the GNU General Public License (GPLv3).
# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
# MSA updated_Arisong_1 nseq 95 (95) alen 65 (150) avgid 66.35 (64.97) nbpairs 20 (20)
# GammaFIT: pmass 0.030701 mu 24.007524 lambda 0.153011 tau 1.256706
# Method Target_E-val cov_at_target_E-val [cov_min,conv_max] [FP | TP True Found | Sen PPV F] 
# GTp    0.05         43.97               [-9.63,121.98]      [3 | 11 20 14 | 55.00 78.57 64.71] 
#       left_pos       right_pos        score   E-value
#------------------------------------------------------------
*	      98	     106	121.98	4.76088e-08
*	     122	     137	95.92	2.2859e-05
*	      96	     108	89.19	6.25194e-05
*	     120	     139	77.12	0.000366434
 	     104	     130	64.22	0.00263112
*	     119	     140	59.65	0.00505242
*	     121	     138	59.15	0.00533404
 	      93	     104	58.99	0.00563123
*	     124	     134	58.40	0.00594484
*	     123	     135	58.24	0.00627579
*	      94	     110	56.89	0.00738228
*	      99	     105	55.36	0.00967195
*	      97	     107	52.27	0.0148803
~	      93	     130	47.91	0.0282835
\end{sreoutput}
A star ``*'' in the first column indicates that the pair is part of
the annotated structure in the \prog{updated\_Arisong.sto} file. A
blank indicates a pair that is not compatible with the structure. A
``$\sim$`` indicates an interaction not in the annotated structure but
compatible with it (none in this example).

\subsection{Default parameters}

Default parameters are:

\begin{sreitems}{\emprog{Pairwise percent identity:}}
\item[\emprog{Target E-value:}]default is 0.05. \rscape\, reports
  pairs which covariation score has E-value smaller or equal to the
  target value.  The target E-value can be changed with option
  \emprog{-E <x>}, $x >= 0$.

\item[\emprog{Pairwise percent identity:}]Sequences with at least
  97\% similarity to each other are removed.  Pairwise \% identity is
  defined as the ratio of identical positions divided by the minimum
  length of the two sequences. The maximum pairwise percentage
  identity in the alignment can be changed with option \emprog{-I
    <x>}, $0<x<=1$.

\item[\emprog{Gaps in columns:}]Columns with more than 50\% gaps are
  removed. The gap threshold for removing columns can be modified
   using option \emprog{--gapthresh <x>} , $0<x<=1$.

 \item[\emprog{Covariation statistic:}]The default covariation statistic
   is the average product corrected G-Test (equivalent to option
   \emprog{--GTp}).

 \item[\emprog{Covariation Class:}]\rscape\ uses the 16 component
   covariation statistic (C16), unless the number of sequences in the
   alignment is $\leq$ 8 or the length of the alignment is $\leq$ 50,
   in which case it uses the two-class covariation statistic (C2). A
   particular covariation class can be selected using either
   \emprog{--C16} or \emprog{--C2}.

   The threshold for the minimum number of sequences can be changed
   with option \prog{--nseqthresh <n>}.  The threshold for the minimum
   alignment length can be changed with option \prog{--alenthresh <n>}.

 \item[\emprog{Null alignments:}]In order to estimate E-values,
   \rscape\ produces 20 null alignments, unless the product of the
   number of sequences by the length of the alignment $<$ 10,000 in
   which case the number of null alignments is 50; or $<$ 1,000 in
   which case it is 100. The number of null alignments can be
   controlled with option \emprog{--nshuffle <n>}.
 \end{sreitems}

 A full list of the \rscape\ options is found by using

 \user{\rscape\ -h}

 
 
